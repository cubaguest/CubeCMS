(function(){tinymce.PluginManager.requireLangPack('imgpreview');tinymce.create('tinymce.plugins.ImagePrewiev',{init:function(ed,url){var t=this;t.editor=ed;ed.addCommand('mceImagePreview',function(){var e=ed.selection.getNode();var pnode=e.parentNode;if(pnode!=null&&pnode.nodeName=='A'&&(ed.dom.hasClass(pnode,'pirobox')||ed.dom.hasClass(pnode,'pirobox_gall'))){var eClone=e.cloneNode(true);ed.dom.remove(e.parentNode);ed.selection.setNode(eClone)}else{var title=ed.dom.getAttrib(e,'alt',null);if(title==null)title=e.src.replace(/^.*\//,'');var gallLink=ed.dom.create('a',{'class':'pirobox','href':e.src.replace('/small/','/medium/'),'title':title});gallLink.appendChild(e.cloneNode(true));ed.dom.remove(e);ed.selection.setNode(gallLink)}ed.nodeChanged()});ed.addButton('imgpreview',{title:'imgpreview.preview',cmd:'mceImagePreview',image:url+'/img/preview_gallery.gif'});ed.onNodeChange.add(function(ed,cm,n){if(n==null)return;cm.setDisabled('imgpreview',n.nodeName!='IMG');cm.setActive('imgpreview',t._havePreview(ed,n))})},getInfo:function(){return{longname:'Image Preview - PiroBox',author:'Cube Studio',authorurl:'http://www.cube-studio.cz',infourl:'http://www.cube-studio.cz/dev/tinymce/plugins/imagepreview/',version:tinymce.majorVersion+"."+tinymce.minorVersion}},_havePreview:function(ed,node){if(node.parentNode!=null&&node.parentNode.nodeName=='A'&&(ed.dom.hasClass(node.parentNode,'pirobox')||ed.dom.hasClass(node.parentNode,'pirobox_gall')))return true;return false}});tinymce.PluginManager.add('imgpreview',tinymce.plugins.ImagePrewiev)})();