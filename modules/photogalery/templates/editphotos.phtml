<?
$this->addJsPlugin(new JsPlugin_SWFUpload());
$this->addJsPlugin(new JsPlugin_PiroBox());
$this->addCssFile("style.css", 'photogalery');
?>
<h1><?= $this->tr('Úprava obrázků z').' '.$this->category()->getName();?></h1>
<?$this->includeFile('tpl://photogalery:addimage.phtml')?>
<h2><?=$this->tr('Seznam uložených obrázků')?></h2>
   <div id="allfiles">
      <form method="post" action="<?=$this->link()?>">
         <div style="text-align: right; padding: 10px;">
            <a href="#" title="<?=$this->tr('Změnit označení pro smazání')?>" id="button-check-all-images"><?=$this->tr('Změnit označení')?></a>
            <?
            echo $this->editForm->save->controll();
            ?>
         </div>
         <div id="edit-photos-list">
            <table style="width:100%;">
            <?$step = 0;
            foreach ($this->images as $image) {
               $step++;?>
            <tr id="file-<?=$image->{PhotoGalery_Model_Images::COLUMN_FILE}?>">
               <td style="width: 75px">
                  <a href="<?=$this->category()->getModule()->getDataDir(true).$this->websubdir.Photogalery_Controller::DIR_MEDIUM.URL_SEPARATOR
               .$image->{PhotoGalery_Model_Images::COLUMN_FILE}?>" class="pirobox_gall" title="<?=$this->tr('Zobrazit náhled')?>"><img
                        src="<?=$this->category()->getModule()->getDataDir(true).$this->websubdir.Photogalery_Controller::DIR_SMALL.URL_SEPARATOR
               .$image->{PhotoGalery_Model_Images::COLUMN_FILE}.'?time='.time()?>" alt="<?=$image->{PhotoGalery_Model_Images::COLUMN_FILE}?>" width="70"
                  /></a>
               </td>
               <td valign="top" style="padding-right:10px;">
                     <?
                     $this->editForm->name->setDimensional($image->{PhotoGalery_Model_Images::COLUMN_ID});
                     $this->editForm->name->setValues(array($image->{PhotoGalery_Model_Images::COLUMN_ID} =>
                             $image->{PhotoGalery_Model_Images::COLUMN_NAME}));
                     echo ($this->editForm->name->label()."<br />");
                     echo ($this->editForm->name->labelLangs());
                     echo ($this->editForm->name->controll());
                     echo ($this->editForm->name->scripts());
                     ?><br />
                     <?
                     $this->editForm->ord->setDimensional($image->{PhotoGalery_Model_Images::COLUMN_ID});
                     $this->editForm->ord->setValues($image->{PhotoGalery_Model_Images::COLUMN_ORDER});
                     echo ($this->editForm->ord->label());
                     $this->editForm->ord->html()->setAttrib('size', 5);
                     echo ($this->editForm->ord->controll());
                     echo ($this->editForm->ord->scripts());
                     ?>
                     <?
                     $this->editForm->delete->setDimensional($image->{PhotoGalery_Model_Images::COLUMN_ID});
                     $this->editForm->delete->setValues(false);
                     echo ($this->editForm->delete->label());
                     echo ($this->editForm->delete->controll()->addClass('button-check-delete-image'));//->setAttrib('onclick', "if(this.checked == true)return confirm('Smazat?')"));
                     echo ($this->editForm->delete->scripts());?>
                     <?
                     $this->editForm->rotate->setLabel('<img src="images/icons/arrow_rotate_anticlockwise.png" />');
                     $this->editForm->rotate->setDimensional($image->{PhotoGalery_Model_Images::COLUMN_ID});
                     echo ($this->editForm->rotate->label());
                     echo ($this->editForm->rotate->controll());?>
               </td>
               <td valign="top">
                     <?
                     $this->editForm->desc->setDimensional($image->{PhotoGalery_Model_Images::COLUMN_ID});
                     $this->editForm->desc->setValues(array($image->{PhotoGalery_Model_Images::COLUMN_ID} =>
                             $image->{PhotoGalery_Model_Images::COLUMN_DESC}));
                     echo ($this->editForm->desc->label()."<br />");
                     echo ($this->editForm->desc->labelLangs());
                     echo ($this->editForm->desc->controll());
                     echo ($this->editForm->desc->scripts());
                     ?>
                     <?
                     $this->editForm->id->setDimensional($image->{PhotoGalery_Model_Images::COLUMN_ID});
                     $this->editForm->id->setValues($image->{PhotoGalery_Model_Images::COLUMN_ID});
                     echo ($this->editForm->id->controll());?>
               </td>
            </tr>
            <tr>
               <td colspan="3" style="border-bottom: 1px solid gray">
                  <a href="<?=$this->link()->route('editphoto',array('id' => $image->{PhotoGalery_Model_Images::COLUMN_ID}))?>"
                     title="<?=$this->tr('Upravit miniaturu')?>"><?=$this->tr('Upravit miniaturu')?></a>
               </td>
            </tr>
            <?}?>
         </table>
         </div>
         <div style="text-align: right; padding: 10px;">
            <?
            echo $this->editForm->save->controll();
            echo ($this->editForm->goBack->label());
            echo ($this->editForm->goBack->controll());
            ?>
         </div>
         <?=$this->editForm->scripts()?>
      </form>
   </div>
