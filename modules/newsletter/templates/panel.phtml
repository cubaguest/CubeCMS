<?
$icon = null;
if($this->panelObj()->getIcon() != null){
   $icon = '<img src="'.Panel_Obj::getIconDir().$this->panelObj()->getIcon().'" alt="'.$this->panelObj()->getIcon().'" />';
}
$backImg = null;
if($this->panelObj()->getBackImage() != null){
   $backImg = 'background-image: url(\''.Panel_Obj::getBackImgDir().$this->panelObj()->getBackImage().'\');';
}
$this->form->html()->addClass('regMailFormPanel');
?>
<div class="name"><?=$icon?><a href="<?=$this->link()?>" title="<?=htmlspecialchars($this->panelObj()->getName())?>"><?=$this->panelObj()->getName()?></a></div>
<div class="content" style="<?=$backImg?>">
   <div class="text">
      <?=$this->tr('Registrace k odběru novinek e-mailem')?>
   </div>
   <div class="text">
   <?echo $this->form->renderStart();?>
      <?
      $this->form->mail->html()->setAttrib('size', '15');
      echo $this->form->mail->label().'<br />';
      echo $this->form->mail->controll().'<br />';?>
      <p>
      <?echo $this->form->send->controll()?><br />
      </p>
      <?echo $this->form->renderEnd();?>
   </div>
</div>
<div class="link-more">
   <a href="<?=$this->link()?>"
      title="<?=htmlspecialchars($this->category()->getLabel())?>"><?=$this->tr('Více')?></a>
</div>
<?if(!defined('VVE_REGMAIL_RENDER')){
define('VVE_REGMAIL_RENDER', true);
   ?>
<script type="text/javascript">
   /* <![CDATA[ */
   $('form.regMailFormPanel').live('submit',function(){
      var jform = $(this);
      showLoadBox(jform);
      $.ajax({
         type: "POST",
         cache: false,
         url: '<?=$this->link()->clear()->route();?>',
         data: jform.serialize(),
         dataType: "json",
         success: function(data) {
            vveShowMessages(data);
            hideLoadBox();
         },
         error : function(){
            hideLoadBox();
         }
      });
      return false;
   });
   /* ]]> */
</script>
<?}?>
