<div>
   <?
   $linkajaxPanelInfo = new Url_Link_ModuleRequest();
   ?>
   <h2><?=$this->_('Seznam globálních panelů');?></h2>
   <br />
   <table>
      <tr>
         <th width="200"><?=$this->_('kategorie')?></th>
         <th width="100"><?=$this->_('box')?></th>
         <th width="90"><?=$this->_('pořadí')?></th>
         <th width="60"><?=$this->_('akce')?></th>
      </tr>
      <?
      $this->panels = $this->gobalpanels;
      $this->includeTpl('listtpl.phtml', false, array('panels' => $this->gobalpanels));?>
   </table>
   <br />
   <br />
   <?
   // POKUD jsou individuální panely
   if(!empty ($this->individualPanelCats)) {?>
   <h2><?=$this->_('Seznam individuálních panelů');?></h2>
   <br />
   <strong><?=$this->_('Kategorie pro zobrazení')?>:</strong>
   <select id="catsList" name="catsList">
         <?foreach ($this->individualPanelCats as $cat) {?>
      <option value="<?=$cat->{Model_Category::COLUMN_CAT_ID}?>"><?=$cat->{Model_Category::COLUMN_CAT_LABEL}?></option>
            <? }?>
   </select>
   <button name="selectCatPanels"><?=$this->_('Vybrat')?></button>
   <br />
   <div><!-- kvuli loadboxu-->
      <table id="indCatPanelsList">
         <thead id="indCatPanelsListHeader">
            <tr>
               <th width="200"><?=$this->_('kategorie')?></th>
               <th width="100"><?=$this->_('box')?></th>
               <th width="90"><?=$this->_('pořadí')?></th>
               <th width="60"><?=$this->_('akce')?></th>
            </tr>
            <tr>
               <td colspan="4"><hr/></td>
            </tr>
         </thead>
         <tbody></tbody>
      </table>
   </div>

   <script type="text/javascript">
      /* <![CDATA[ */
      $(document).ready(function(){
         loadPanels();

   $('button[name=selectCatPanels]').click(function(){
      loadPanels();
      return false;
   });
   $('select[name=catsList]').change(function(){
      loadPanels();
      return false;
   });
      });

      function loadPanels(){
         showLoadBox($('table#indCatPanelsList'));
         $.ajax({
            url: '<?=$this->link()->route('getListPanels')?>?idc='+$('select#catsList').val(),
            success: function(data) {
               $('table#indCatPanelsList tbody').html(data);
               hideLoadBox();
            }
         });
      }
      /* ]]> */
   </script>
      <?}?>

   <? echo $this->toolbox;?>
</div>

