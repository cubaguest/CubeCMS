<?
$this->addCssFile("style.css");

$model = new Text_Model_Detail();
$text = $model->getText(Category::getSelectedCategory()->getId());
$modelImages = new PhotoGalery_Model_Images();
$images = $modelImages->getImages($this->category()->getId());

// jquery galerka
$this->addJsPlugin(new JsPlugin_PiroBox());

?>
<div class="imagesList">
   <?if($text != null) {?>
   <div>
         <?=$text->{Text_Model_Detail::COLUMN_TEXT}?>
   </div>
   <br />
   <?}?>

   <!-- Start Advanced Gallery Html Containers -->
   <div class="navigation-container">
      <?while ($image = $images->fetch()) {
         ?>
      <a class="pirobox_gall" href="<?=$this->category()->getModule()->getDataDir(true)
                .Photogalery_Controller::DIR_MEDIUM.URL_SEPARATOR.$image[PhotoGalery_Model_Images::COLUMN_FILE]?>"
         title="<?=$image->{PhotoGalery_Model_Images::COLUMN_NAME}?>">
         <img src="<?=$this->category()->getModule()->getDataDir(true).Photogalery_Controller::DIR_SMALL.URL_SEPARATOR
                     .$image[PhotoGalery_Model_Images::COLUMN_FILE]?>" alt="<?=$image->{PhotoGalery_Model_Images::COLUMN_NAME}?>" />
      </a>
      <!--<div class="caption">
         <?if((string)$image->{PhotoGalery_Model_Images::COLUMN_NAME} != null) {?>
         <div class="image-title"><?=$image->{PhotoGalery_Model_Images::COLUMN_NAME}?></div>
         <?}?>
         <?if((string)$image->{PhotoGalery_Model_Images::COLUMN_DESC} != null) {?>
         <div class="image-desc"><?=$image->{PhotoGalery_Model_Images::COLUMN_DESC}?></div>
         <?}?>
      </div>-->
      <?}?>
   </div>
   <!-- End Gallery Html Containers -->
   <hr class="reseter" />

   <script type="text/javascript">
      /* <![CDATA[ */
      $(document).ready(function(){
         $().piroBox({
            my_speed: 300, //animation speed
            bg_alpha: 0.8, //background opacity
            radius: 4, //caption rounded corner
            scrollImage : false, // true == image follows the page _|_ false == image remains in the same open position
            // in some cases of very large images or long description could be useful.
            slideShow : 'slideshow', // true == slideshow on, false == slideshow off
            slideSpeed : 3, //slideshow
            pirobox_next : 'piro_next', // Nav buttons -> piro_next == inside piroBox , piro_next_out == outside piroBox
            pirobox_prev : 'piro_prev', // Nav buttons -> piro_prev == inside piroBox , piro_prev_out == outside piroBox
            close_all : '.piro_close' // add class .piro_overlay(with comma)if you want overlay click close piroBox
         });
      });

      /* ]]> */
   </script>
   <?
   if($this->category()->getRights()->isWritable()) {
      $toolbox = new Template_Toolbox();
      $toolbox->addTool('edit_text', $this->_("Upravit text"),
          $this->link()->route('edittext'),
          $this->_("Upravit text galerie"), "page_edit.png");
      $toolbox->addTool('edit_images', $this->_("Upravit obrÃ¡zky"),
          $this->link()->route('editimages'),
          $this->_("Upravit text galerie"), "image_edit.png");
      $this->includeTplObj($toolbox);
   }?>
</div>
